<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram QR Scanner</title>
    <script>
        window.addEventListener('load', function() {
            // Проверка наличия Telegram WebApp API
            if (window.Telegram && window.Telegram.WebApp) {
                console.log("Telegram WebApp API инициализировано.");
                window.Telegram.WebApp.ready();  // Инициализация WebApp API

                // Активация кнопки "Сканировать QR-код"
                const scanButton = document.getElementById('scan-button');
                scanButton.disabled = false;  // Делаем кнопку активной
            } else {
                // Сообщение об ошибке, если API не найден
                alert('Telegram WebApp API недоступен. Убедитесь, что WebApp запущен внутри Telegram.');
                console.log('Ошибка: Telegram WebApp API не найдено');
            }
        });

        // Функция для сканирования QR-кода
        function scanQRCode() {
            // Проверка наличия функции showScanQrPopup
            if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.showScanQrPopup) {
                console.log('Открытие окна сканирования QR-кода...');
                window.Telegram.WebApp.showScanQrPopup({
                    text: 'Сканировать QR-код',
                    onSuccess: function(data) {
                        console.log('QR-код успешно отсканирован:', data);
                        // Отправляем отсканированные данные обратно в бота
                        window.Telegram.WebApp.sendData(data);
                    },
                    onError: function() {
                        console.log('Ошибка при сканировании QR-кода.');
                        alert('Не удалось распознать QR-код. Попробуйте еще раз.');
                    }
                });
            } else {
                alert('Сканирование QR-кодов недоступно. Убедитесь, что WebApp запущен на мобильном устройстве в приложении Telegram.');
                console.log('Ошибка: Функция showScanQrPopup недоступна.');
            }
        }
    </script>
</head>
<body>
    <h1>Нажмите кнопку для сканирования QR-кода</h1>
    <button id="scan-button" onclick="scanQRCode()" disabled>Сканировать QR-код</button>
</body>
</html>

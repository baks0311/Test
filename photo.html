<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Photo Capture</title>
</head>
<body>
    <h1>Take a Photo</h1>
    <p id="photo-status">Your photo will appear here.</p>
    <button onclick="takePhoto()">Сфотографировать</button>

    <script>
        // Telegram WebApp API initialization
        Telegram.WebApp.ready();

        function takePhoto() {
            const photo = "data:image/jpeg;base64,..."; // Симуляция полученного фото
            document.getElementById("photo-status").textContent = "Photo taken!";

            // Показать фото на странице
            const img = document.createElement("img");
            img.src = photo;
            document.body.appendChild(img);

            // Отправка фото через Telegram WebApp API
            sendPhoto(photo);
        }

        function sendPhoto(photoData) {
            if (!photoData) {
                alert('Ошибка: Не удалось сделать фото.');
                return;
            }

            const data = JSON.stringify({
                imageData: photoData  // base64 строка изображения
            });

            try {
                // Проверка, что API инициализировано
                if (Telegram.WebApp) {
                    // Вызов асинхронной функции с подтверждением через пользовательское действие
                    Telegram.WebApp.sendData(data);  // Отправляем данные в бота
                    alert('Фото успешно отправлено!');
                } else {
                    alert('Ошибка: Telegram WebApp API не инициализировано.');
                }
            } catch (error) {
                console.error('Ошибка при отправке данных: ', error);
                alert('Ошибка при отправке фото.');
            }
        }
    </script>
</body>
</html>
